/** coolay-v1.0.0 MIT License By https://github.com/ninggf/coolayui */
 ;layui.define(["jquery"],function(t){"use strict";var a=layui.$;t("&install",new Vue({el:".install",data:{step:[{title:"环境检测",name:"home"},{title:"安全码验证",name:"verify"},{title:"环境选择",name:"config"},{title:"数据库配置",name:"db"},{title:"创建管理员",name:"user"},{title:"安装",name:"install"},{title:"完成",name:"finfish"}],requirements:window.vueData.requirements,dirs:window.vueData.dirs,status:0,data:{code:"",config:"",db:"MYSQL",dbname:"",dbusername:"",dbpwd:"",host:"",port:"",username:"",userpwd:""},current:"home",install_progress:0,tips:""},methods:{verifyNext:function(){var e=1;return this.requirements.map(function(t){t[1].pass|t[1].optional||(e=0)}),this.dirs.map(function(t){t[1].pass|t[1].optional||(e=0)}),e},go:function(t){var e=this;e.tips="";for(var s=e.status=0;s<e.step.length;s++)if(e.step[s].name==e.current)return void(e.current="next"==t?e.step[s+1].name:e.step[s-1].name)},verify:function(){var e=this;this.status=1,a.post("installer/verify",{code:e.data.code},function(t){e.status=2})},setup:function(t){var e=this,s={};switch(t){case"config":s.config=e.data.config;break;case"db":s.db=e.data.db,s.dbname=e.data.dbname,s.dbusername=e.data.dbusername,s.dbpwd=e.data.dbpwd,s.host=e.data.host,s.port=e.data.port;break;case"user":s.username=e.data.username,s.dbpwd=e.data.dbpwd}this.status=1,a.post("installer/setup",s,function(t){0==t.status?(e.current=t.step,e.tips=t.msg||"tips",e.status=0):e.status=2})},doInstall:function(){var t,e=this;t=setInterval(function(){e.install_progress++,layui.element.progress("install-progress",e.install_progress+"%"),100<=e.install_progress&&clearInterval(t)},50)}},mounted:function(){},watch:{}}))});