layui.define(['&coolay', 'jquery'], function (exports) {
  'use strict';

  var $ = layui.$,
      coolay = layui['&coolay'];
  var menu = null,
      app = null,
      home = {
    init: function init(menu) {
      app = new Vue({
        el: '#index',
        data: {
          menu: {
            show: 0,
            listshow: 0,
            search_focus: 0,
            module_show: 0,
            collection_list: [],
            menu_list: menu,
            res_list: {
              title: "搜索结果",
              lists: []
            },
            current_menu: -1
          },
          // 拖动
          drop: {
            start: '',
            target: '',
            current: -1
          },
          ajax: {
            error: 0,
            success: 0
          },
          search: {
            search_val: '',
            t: "",
            res: []
          }
        },
        methods: {
          // 标签添加到左侧sider
          collection: function collection(item) {
            var el;

            if (item.isadd) {
              // 删除
              el = this.menu.collection_list.findIndex(function (c) {
                return c.name == item.name;
              });
              this.menu.collection_list.splice(el, 1);
            } else {
              //添加
              this.menu.collection_list.push(item);
            }

            item.isadd = !item.isadd;
          },
          dragstart: function dragstart(item) {
            this.drop.start = item;
          },
          dragend: function dragend() {
            //结束拖动
            var sindex,
                tindex,
                $vm = this;

            if (this.drop.start.name != this.drop.target.name) {
              sindex = this.menu.collection_list.findIndex(function (c) {
                return c.name == $vm.drop.start.name;
              });
              tindex = this.menu.collection_list.findIndex(function (c) {
                return c.name == $vm.drop.target.name;
              });
              this.menu.collection_list.splice(sindex, 1, this.drop.target);
              this.menu.collection_list.splice(tindex, 1, this.drop.start);
              this.drop.current = -1;
            }
          },
          dragenter: function dragenter(item) {
            //拖动中 展示拖动效果
            this.drop.current = this.menu.collection_list.findIndex(function (c) {
              return c.name == item.name;
            });
            this.drop.target = item;
          },
          clickMenu: function clickMenu(item) {
            this.getHtml(item);
            history.pushState({
              comp: item
            }, item.url, item.url);
            this.menu.show = 0;
            this.menu.listshow = 0;
          },
          searchMenu: function searchMenu(e) {
            var $vm = this,
                arr = [];

            if (!$vm.search.search_val) {
              $vm.search.res = [];
              return;
            }

            if ($vm.search.t) {
              window.clearTimeout($vm.search.t);
              $vm.search.t = 0;
            } //设时延迟0.8s执行


            $vm.search.t = setTimeout(function () {
              $vm.search.t = 0;
              $vm.search.res = [];
              $vm.search.res = $vm.menu.menu_list.map(function (item, i, arr) {
                arr = item.lists.filter(function (item_sub) {
                  return item_sub.name.includes($vm.search.search_val);
                });
                return {
                  title: item.title,
                  lists: arr
                };
              });
              $vm.search.res = $vm.search.res.filter(function (item) {
                return item.lists.length;
              });
            }, 800);
          },
          getHtml: function getHtml(item) {
            var $vm = this;
            $.ajax({
              url: item.url,
              method: 'GET',
              timeout: 5000,
              beforeSend: function beforeSend(req) {
                req.setRequestHeader('PJAX', '1'); //初始化进度条

                $vm.ajax.error = 0;
                $vm.ajax.success = 0;
                $('.layui-progress').show();
                layui.element.progress('install-progress', '0');
              },
              success: function success(res) {
                var workspace = $('#workspace .view');
                workspace.html(res);
                layui.element.progress('install-progress', '100%');
              },
              complete: function complete(XMLHttpRequest, status) {
                //删除进度条
                setTimeout(function () {
                  layui.element.progress('install-progress', '0');
                  $('.layui-progress').hide();
                  $vm.ajax.error = 0;
                }, 2000);
              },
              error: function error(res) {
                //接口请求失败
                console.log(res.responseText);
                var workspace = $('#workspace .view');
                workspace.html(res.responseText);
                layui.element.progress('install-progress', '100%');
                setTimeout(function () {
                  $vm.ajax.error = 1;
                }, 500);
              },
              dataType: 'html'
            });
          }
        },
        mounted: function mounted() {
          var $vm = this;

          window.onpopstate = function (e) {
            if (e.state) {
              $vm.getHtml(e.state.comp);
            }
          };
        }
      });
    }
  };
  exports('@backend.index', home);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImxheXVpIiwiZGVmaW5lIiwiZXhwb3J0cyIsImxldCIsIiQiLCJjb29sYXkiLCJtZW51IiwiYXBwIiwiaG9tZSIsImluaXQiLCJWdWUiLCJlbCIsImRhdGEiLCJzaG93IiwibGlzdHNob3ciLCJzZWFyY2hfZm9jdXMiLCJtb2R1bGVfc2hvdyIsImNvbGxlY3Rpb25fbGlzdCIsIm1lbnVfbGlzdCIsInJlc19saXN0IiwidGl0bGUiLCJsaXN0cyIsImN1cnJlbnRfbWVudSIsImRyb3AiLCJzdGFydCIsInRhcmdldCIsImN1cnJlbnQiLCJhamF4IiwiZXJyb3IiLCJzdWNjZXNzIiwic2VhcmNoIiwic2VhcmNoX3ZhbCIsInQiLCJyZXMiLCJtZXRob2RzIiwiY29sbGVjdGlvbiIsIml0ZW0iLCJpc2FkZCIsImZpbmRJbmRleCIsImMiLCJuYW1lIiwic3BsaWNlIiwicHVzaCIsImRyYWdzdGFydCIsImRyYWdlbmQiLCJzaW5kZXgiLCJ0aW5kZXgiLCIkdm0iLCJkcmFnZW50ZXIiLCJjbGlja01lbnUiLCJnZXRIdG1sIiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsImNvbXAiLCJ1cmwiLCJzZWFyY2hNZW51IiwiZSIsImFyciIsIndpbmRvdyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJtYXAiLCJpIiwiZmlsdGVyIiwiaXRlbV9zdWIiLCJpbmNsdWRlcyIsImxlbmd0aCIsIm1ldGhvZCIsInRpbWVvdXQiLCJiZWZvcmVTZW5kIiwicmVxIiwic2V0UmVxdWVzdEhlYWRlciIsImVsZW1lbnQiLCJwcm9ncmVzcyIsIndvcmtzcGFjZSIsImh0bWwiLCJjb21wbGV0ZSIsIlhNTEh0dHBSZXF1ZXN0Iiwic3RhdHVzIiwiaGlkZSIsImNvbnNvbGUiLCJsb2ciLCJyZXNwb25zZVRleHQiLCJkYXRhVHlwZSIsIm1vdW50ZWQiLCJvbnBvcHN0YXRlIiwic3RhdGUiXSwibWFwcGluZ3MiOiJBQUFBQSxLQUFLLENBQUNDLE1BQU5ELENB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QyxDQUFDLGtCQUFELENBQWY7QUFDQXNFLGdCQUFBQSxTQUFTLENBQUNDLElBQVZELENBQWV6QyxHQUFHLENBQUNpRCxZQUFuQlI7QUFDQTFFLGdCQUFBQSxLQUFLLENBQUN3RSxPQUFOeEUsQ0FBY3lFLFFBQWR6RSxDQUF1QixrQkFBdkJBLEVBQTJDLE1BQTNDQTtBQUNBNEQsZ0JBQUFBLFVBQVUsQ0FBQyxZQUFVO0FBQ2pCYixrQkFBQUEsR0FBRyxDQUFDcEIsSUFBSm9CLENBQVNuQixLQUFUbUIsR0FBaUIsQ0FBakJBO0FBQ0gsaUJBRlMsRUFFUixHQUZRLENBQVZhO0FBSUgsZUFwQ0U7QUFxQ0h1QixjQUFBQSxRQUFRLEVBQUM7QUFyQ04sYUFBUC9FO0FBdUNIO0FBcEhJLFNBakNDO0FBd0pWZ0YsUUFBQUEsT0F4SlUscUJBd0pBO0FBQ05qRixjQUFJNEMsR0FBRyxHQUFDLElBQVI1Qzs7QUFDQXVELFVBQUFBLE1BQU0sQ0FBQzJCLFVBQVAzQixHQUFvQixVQUFTRixDQUFULEVBQVk7QUFDNUIsZ0JBQUdBLENBQUMsQ0FBQzhCLEtBQUwsRUFBVztBQUNQdkMsY0FBQUEsR0FBRyxDQUFDRyxPQUFKSCxDQUFZUyxDQUFDLENBQUM4QixLQUFGOUIsQ0FBUUgsSUFBcEJOO0FBQ0o7QUFDSixXQUpBVztBQUtKO0FBL0pVLE9BQVIsQ0FBTm5EO0FBaUtKO0FBbks2QixHQUFqQ0o7QUFzS0FELEVBQUFBLE9BQU8sQ0FBQyxnQkFBRCxFQUFtQk0sSUFBbkIsQ0FBUE47QUFDSCxDQTFLREYiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJsYXl1aS5kZWZpbmUoWycmY29vbGF5JywnanF1ZXJ5J10sIChleHBvcnRzKSA9PiB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBsZXQgJCA9IGxheXVpLiQsY29vbGF5ID0gbGF5dWlbJyZjb29sYXknXVxyXG4gICAgbGV0IG1lbnUgPSBudWxsLGFwcD0gbnVsbCxob21lID0ge1xyXG4gICAgICAgIGluaXQgKG1lbnUpe1xyXG4gICAgICAgICAgICBhcHAgPSBuZXcgVnVlKHtcclxuICAgICAgICAgICAgICAgIGVsICAgICA6ICcjaW5kZXgnLFxyXG4gICAgICAgICAgICAgICAgZGF0YSAgIDoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lbnU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvdyAgICAgICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0c2hvdyAgICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaF9mb2N1cyAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlX3Nob3cgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uX2xpc3Q6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51X2xpc3QgICAgICA6IG1lbnUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc19saXN0OntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOlwi5pCc57Si57uT5p6cXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0czpbXSwgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X21lbnUgICA6IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5ouW5YqoXHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydCAgOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0IDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgYWpheDp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOjAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6MCxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaDp7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaF92YWw6JycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQ6XCJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzOltdLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kczoge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOagh+etvua3u+WKoOWIsOW3puS+p3NpZGVyXHJcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNhZGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWIoOmZpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwgPSB0aGlzLm1lbnUuY29sbGVjdGlvbl9saXN0LmZpbmRJbmRleChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjLm5hbWUgPT0gaXRlbS5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNvbGxlY3Rpb25fbGlzdC5zcGxpY2UoZWwsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mt7vliqBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jb2xsZWN0aW9uX2xpc3QucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmlzYWRkID0gIWl0ZW0uaXNhZGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBkcmFnc3RhcnQoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3Auc3RhcnQgPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZHJhZ2VuZCgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/nu5PmnZ/mi5bliqhcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNpbmRleCwgdGluZGV4LCAkdm0gPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kcm9wLnN0YXJ0Lm5hbWUgIT0gdGhpcy5kcm9wLnRhcmdldC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW5kZXggPSB0aGlzLm1lbnUuY29sbGVjdGlvbl9saXN0LmZpbmRJbmRleChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjLm5hbWUgPT0gJHZtLmRyb3Auc3RhcnQubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW5kZXggPSB0aGlzLm1lbnUuY29sbGVjdGlvbl9saXN0LmZpbmRJbmRleChmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjLm5hbWUgPT0gJHZtLmRyb3AudGFyZ2V0Lm5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNvbGxlY3Rpb25fbGlzdC5zcGxpY2Uoc2luZGV4LCAxLCB0aGlzLmRyb3AudGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jb2xsZWN0aW9uX2xpc3Quc3BsaWNlKHRpbmRleCwgMSwgdGhpcy5kcm9wLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJvcC5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRyYWdlbnRlcihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5ouW5Yqo5LitIOWxleekuuaLluWKqOaViOaenFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3AuY3VycmVudCA9IHRoaXMubWVudS5jb2xsZWN0aW9uX2xpc3QuZmluZEluZGV4KGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5uYW1lID09IGl0ZW0ubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcm9wLnRhcmdldCAgPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xpY2tNZW51KGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEh0bWwoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnkucHVzaFN0YXRlKHtjb21wOiBpdGVtfSwgaXRlbS51cmwsIGl0ZW0udXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LnNob3c9MDt0aGlzLm1lbnUubGlzdHNob3c9MFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoTWVudShlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IFskdm0sYXJyXT1bdGhpcyxbXV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoISR2bS5zZWFyY2guc2VhcmNoX3ZhbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdm0uc2VhcmNoLnJlcz1bXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZigkdm0uc2VhcmNoLnQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCgkdm0uc2VhcmNoLnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHZtLnNlYXJjaC50PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/orr7ml7blu7bov58wLjhz5omn6KGMXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR2bS5zZWFyY2gudD1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHZtLnNlYXJjaC50PTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdm0uc2VhcmNoLnJlcz1bXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2bS5zZWFyY2gucmVzPSR2bS5tZW51Lm1lbnVfbGlzdC5tYXAoZnVuY3Rpb24oaXRlbSxpLGFycil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyPWl0ZW0ubGlzdHMuZmlsdGVyKGZ1bmN0aW9uKGl0ZW1fc3ViKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1fc3ViLm5hbWUuaW5jbHVkZXMoJHZtLnNlYXJjaC5zZWFyY2hfdmFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOml0ZW0udGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RzOmFyclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdm0uc2VhcmNoLnJlcz0kdm0uc2VhcmNoLnJlcy5maWx0ZXIoZnVuY3Rpb24oaXRlbSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubGlzdHMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSw4MDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdldEh0bWwoaXRlbSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdm09dGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDppdGVtLnVybCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDonR0VUJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6NTAwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKHJlcSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ1BKQVgnLCcxJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WIneWni+WMlui/m+W6puadoVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2bS5hamF4LmVycm9yICAgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2bS5hamF4LnN1Y2Nlc3MgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5sYXl1aS1wcm9ncmVzcycpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXl1aS5lbGVtZW50LnByb2dyZXNzKCdpbnN0YWxsLXByb2dyZXNzJywgJzAnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczpmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3Jrc3BhY2U9JCgnI3dvcmtzcGFjZSAudmlldycpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5odG1sKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheXVpLmVsZW1lbnQucHJvZ3Jlc3MoJ2luc3RhbGwtcHJvZ3Jlc3MnLCAnMTAwJScpOyAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOmZ1bmN0aW9uKFhNTEh0dHBSZXF1ZXN0LHN0YXR1cyl7ICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yig6Zmk6L+b5bqm5p2hXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheXVpLmVsZW1lbnQucHJvZ3Jlc3MoJ2luc3RhbGwtcHJvZ3Jlc3MnLCAnMCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcubGF5dWktcHJvZ3Jlc3MnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2bS5hamF4LmVycm9yID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LDIwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOmZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqXlj6Por7fmsYLlpLHotKVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd29ya3NwYWNlPSQoJyN3b3Jrc3BhY2UgLnZpZXcnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5odG1sKHJlcy5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheXVpLmVsZW1lbnQucHJvZ3Jlc3MoJ2luc3RhbGwtcHJvZ3Jlc3MnLCAnMTAwJScpOyAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHZtLmFqYXguZXJyb3IgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sNTAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOidodG1sJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBtb3VudGVkKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCAkdm09dGhpcztcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZS5zdGF0ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdm0uZ2V0SHRtbChlLnN0YXRlLmNvbXApICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZXhwb3J0cygnQGJhY2tlbmQuaW5kZXgnLCBob21lKTtcclxufSk7XHJcbiJdfQ==
