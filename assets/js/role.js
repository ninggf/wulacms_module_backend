function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}layui.define(['layer','form','util','admin','zTree','xmSelect','treeTable','notice'],function(exports){var $=layui.jquery;var layer=layui.layer;var form=layui.form;var treeTable=layui.treeTable;var admin=layui.admin;var notice=layui.notice;var xmSelect=layui.xmSelect,index=top.layui.index;var Role=/*#__PURE__*/function(){function Role(){_defineProperty(this,"insTb",void 0);}var _proto=Role.prototype;_proto.init=function init(){this.insTb=treeTable.render({elem:'#roleTable',url:admin.url('backend/role/list'),id:'roleList',page:true,toolbar:$('#operationToolbar').html(),defaultToolbar:["filter"],cellMinWidth:100,cols:[[{type:'checkbox'},{type:'numbers',title:'序号',width:80},{field:'role',title:'角色',sort:false,width:200,templet:function templet(d){return d.role+(d.system?'&nbsp;<span class="layui-badge layui-bg-green">S</span>':'');}},{field:'name',title:'标识',sort:false,width:100},{field:'remark',title:'备注',sort:false},{field:'_ops',title:'操作',toolbar:'#roleTbBar',align:'center',width:140,minWidth:140}]],text:{none:'<div style="padding: 18px 0;">哎呀，当前无角色数据,快去添加吧~</div>'},tree:{openName:'role',iconIndex:2,idName:'id',pidName:'pid',isPidData:true,arrowType:'arrow2',getIcon:function getIcon(d){return'<i class="ew-tree-icon"></i>';}}});var _this=this;/* 表格搜索 */form.on('submit(roleTbSearch)',function(data){_this.insTb.reload({where:data.field,page:{curr:1}});return false;});treeTable.on('tool(roleTable)',function(obj){var id=obj.data.id;switch(obj.event){case'edit'://编辑
_this.showEditModel(obj.data);break;case'del'://删除
_this.doDel({'ids':[id]});break;case'auth'://授权
index.openTab({url:admin.url('backend/role/grant?rid='+id),title:obj.data.role+' '+_t('Permissions'),end:''});break;case'view'://查看
break;}});treeTable.on('toolbar(roleTable)',function(obj){if(obj.event==='add'){// 添加
_this.showEditModel();}else if(obj.event==='del'){// 删除
var checkRows=_this.insTb.checkStatus('roleList');if(checkRows.length===0){layer.msg('请选择要删除的角色',{icon:2});return;}var ids=checkRows.map(function(d){return d.id;});_this.doDel({ids:ids});}});};_proto.showEditModel=function showEditModel(mData){var insTb=this.insTb;var url=admin.url(mData?'backend/role/save':'backend/role/add');admin.open({type:1,area:'600px',offset:10,title:(mData?'修改':'添加')+'角色',content:$('#roleEditDialog').html(),success:function success(layero,dIndex){// 回显表单数据
form.val('roleEditForm',mData);// 表单提交事件
form.on('submit(roleEditSubmit)',function(data){var loadIndex=layer.load(2);admin.post(admin.url(url),data.field).then(function(data){layer.close(loadIndex);if(data.code===200){layer.close(dIndex);var msg=mData?'修改':'添加';notice.success('角色'+msg+'成功');insTb.refresh();}else{notice.error(data.message);}}).fail(function(data){layer.close(loadIndex);notice.error(data.message);});return false;});//显示角色上级
var insXmSel=xmSelect.render({el:'#rolesEditParentSel',height:'250px',data:[],tips:'请选择上级角色',name:'pid',initValue:mData?[mData.pid]:[0],model:{label:{type:'text'}},prop:{name:'role',value:'id'},radio:true,clickClose:true});var id=mData?mData.id:0;admin.get('backend/role/list?id='+id).then(function(data){var topRoleList=[];topRoleList.push({'role':'无','id':0});topRoleList=topRoleList.concat(data.tree);insXmSel.update({data:topRoleList,tree:{show:true,showFolderIcon:true,indent:15,strict:false,expandedKeys:[1],simple:true},autoRow:true});});$(layero).children('.layui-layer-content').css('overflow','visible');}});};_proto.doDel=function doDel(obj){var insTb=this.insTb;layer.confirm('确定要删除选中的角色吗？',{skin:'layui-layer-admin',shade:.1},function(i){layer.close(i);var loadIndex=layer.load(2);admin.post('backend/role/del',obj).then(function(data){layer.close(loadIndex);if(data.code===200){notice.success('角色删除成功');insTb.refresh();}else{notice.error(data.message);}}).fail(function(data){layer.close(loadIndex);notice.error(data.message);});});};return Role;}();exports('@backend.role',new Role());});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvbGUudnVlIl0sIm5hbWVzIjpbImxheXVpIiwiZGVmaW5lIiwiZXhwb3J0cyIsIiQiLCJqcXVlcnkiLCJsYXllciIsImZvcm0iLCJ0cmVlVGFibGUiLCJhZG1pbiIsIm5vdGljZSIsInhtU2VsZWN0IiwiaW5kZXgiLCJ0b3AiLCJSb2xlIiwiaW5pdCIsImluc1RiIiwicmVuZGVyIiwiZWxlbSIsInVybCIsImlkIiwicGFnZSIsInRvb2xiYXIiLCJodG1sIiwiZGVmYXVsdFRvb2xiYXIiLCJjZWxsTWluV2lkdGgiLCJjb2xzIiwidHlwZSIsInRpdGxlIiwid2lkdGgiLCJmaWVsZCIsInNvcnQiLCJ0ZW1wbGV0IiwiZCIsInJvbGUiLCJzeXN0ZW0iLCJhbGlnbiIsIm1pbldpZHRoIiwidGV4dCIsIm5vbmUiLCJ0cmVlIiwib3Blbk5hbWUiLCJpY29uSW5kZXgiLCJpZE5hbWUiLCJwaWROYW1lIiwiaXNQaWREYXRhIiwiYXJyb3dUeXBlIiwiZ2V0SWNvbiIsIl90aGlzIiwib24iLCJkYXRhIiwicmVsb2FkIiwid2hlcmUiLCJjdXJyIiwib2JqIiwiZXZlbnQiLCJzaG93RWRpdE1vZGVsIiwiZG9EZWwiLCJvcGVuVGFiIiwiX3QiLCJlbmQiLCJjaGVja1Jvd3MiLCJjaGVja1N0YXR1cyIsImxlbmd0aCIsIm1zZyIsImljb24iLCJpZHMiLCJtYXAiLCJtRGF0YSIsIm9wZW4iLCJhcmVhIiwib2Zmc2V0IiwiY29udGVudCIsInN1Y2Nlc3MiLCJsYXllcm8iLCJkSW5kZXgiLCJ2YWwiLCJsb2FkSW5kZXgiLCJsb2FkIiwicG9zdCIsInRoZW4iLCJjbG9zZSIsImNvZGUiLCJyZWZyZXNoIiwiZXJyb3IiLCJtZXNzYWdlIiwiZmFpbCIsImluc1htU2VsIiwiZWwiLCJoZWlnaHQiLCJ0aXBzIiwibmFtZSIsImluaXRWYWx1ZSIsInBpZCIsIm1vZGVsIiwibGFiZWwiLCJwcm9wIiwidmFsdWUiLCJyYWRpbyIsImNsaWNrQ2xvc2UiLCJnZXQiLCJ0b3BSb2xlTGlzdCIsInB1c2giLCJjb25jYXQiLCJ1cGRhdGUiLCJzaG93Iiwic2hvd0ZvbGRlckljb24iLCJpbmRlbnQiLCJzdHJpY3QiLCJleHBhbmRlZEtleXMiLCJzaW1wbGUiLCJhdXRvUm93IiwiY2hpbGRyZW4iLCJjc3MiLCJjb25maXJtIiwic2tpbiIsInNoYWRlIiwiaSJdLCJtYXBwaW5ncyI6InNMQUFBQSxLQUFLLENBQUNDLE1BQU4sQ0FBYSxDQUFDLE9BQUQsQ0FBVSxNQUFWLENBQWtCLE1BQWxCLENBQTBCLE9BQTFCLENBQW1DLE9BQW5DLENBQTRDLFVBQTVDLENBQXdELFdBQXhELENBQXFFLFFBQXJFLENBQWIsQ0FBNkYsU0FBVUMsT0FBVixDQUFtQixDQUM5RyxHQUFJQyxDQUFBQSxDQUFDLENBQVdILEtBQUssQ0FBQ0ksTUFBdEIsQ0FDQSxHQUFJQyxDQUFBQSxLQUFLLENBQU9MLEtBQUssQ0FBQ0ssS0FBdEIsQ0FDQSxHQUFJQyxDQUFBQSxJQUFJLENBQVFOLEtBQUssQ0FBQ00sSUFBdEIsQ0FDQSxHQUFJQyxDQUFBQSxTQUFTLENBQUdQLEtBQUssQ0FBQ08sU0FBdEIsQ0FDQSxHQUFJQyxDQUFBQSxLQUFLLENBQU9SLEtBQUssQ0FBQ1EsS0FBdEIsQ0FDQSxHQUFJQyxDQUFBQSxNQUFNLENBQU1ULEtBQUssQ0FBQ1MsTUFBdEIsQ0FDQSxHQUFJQyxDQUFBQSxRQUFRLENBQUlWLEtBQUssQ0FBQ1UsUUFBdEIsQ0FBZ0NDLEtBQUssQ0FBR0MsR0FBRyxDQUFDWixLQUFKLENBQVVXLEtBQWxELENBUDhHLEdBU3hHRSxDQUFBQSxJQVR3RyxnSEFZNUdDLElBWjRHLENBWTVHLGVBQU8sQ0FDTCxLQUFLQyxLQUFMLENBQWFSLFNBQVMsQ0FBQ1MsTUFBVixDQUFpQixDQUM1QkMsSUFBSSxDQUFZLFlBRFksQ0FFNUJDLEdBQUcsQ0FBYVYsS0FBSyxDQUFDVSxHQUFOLENBQVUsbUJBQVYsQ0FGWSxDQUc1QkMsRUFBRSxDQUFjLFVBSFksQ0FJNUJDLElBQUksQ0FBWSxJQUpZLENBSzVCQyxPQUFPLENBQVNsQixD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UkgsQ0FRUSxTQUFVcEMsSUFBVixDQUFnQixDQUN0QjVDLEtBQUssQ0FBQzJFLEtBQU4sQ0FBWUosU0FBWixFQUNBbkUsTUFBTSxDQUFDMEUsS0FBUCxDQUFhbEMsSUFBSSxDQUFDbUMsT0FBbEIsRUFDRCxDQVhELEVBWUQsQ0FsQkQsRUFtQkQsQ0FyTDJHLGlCQXdMOUdsRixPQUFPLENBQUMsZUFBRCxDQUFrQixHQUFJVyxDQUFBQSxJQUFKLEVBQWxCLENBQVAsQ0FDRCxDQXpMRCIsInNvdXJjZXNDb250ZW50IjpbImxheXVpLmRlZmluZShbJ2xheWVyJywgJ2Zvcm0nLCAndXRpbCcsICdhZG1pbicsICd6VHJlZScsICd4bVNlbGVjdCcsICd0cmVlVGFibGUnLCAnbm90aWNlJ10sIGZ1bmN0aW9uIChleHBvcnRzKSB7XG4gIGxldCAkICAgICAgICAgPSBsYXl1aS5qcXVlcnk7XG4gIGxldCBsYXllciAgICAgPSBsYXl1aS5sYXllcjtcbiAgbGV0IGZvcm0gICAgICA9IGxheXVpLmZvcm07XG4gIGxldCB0cmVlVGFibGUgPSBsYXl1aS50cmVlVGFibGU7XG4gIGxldCBhZG1pbiAgICAgPSBsYXl1aS5hZG1pbjtcbiAgbGV0IG5vdGljZSAgICA9IGxheXVpLm5vdGljZTtcbiAgbGV0IHhtU2VsZWN0ICA9IGxheXVpLnhtU2VsZWN0LCBpbmRleCA9IHRvcC5sYXl1aS5pbmRleDtcblxuICBjbGFzcyBSb2xlIHtcbiAgICBpbnNUYlxuXG4gICAgaW5pdCgpIHtcbiAgICAgIHRoaXMuaW5zVGIgPSB0cmVlVGFibGUucmVuZGVyKHtcbiAgICAgICAgZWxlbSAgICAgICAgICA6ICcjcm9sZVRhYmxlJyxcbiAgICAgICAgdXJsICAgICAgICAgICA6IGFkbWluLnVybCgnYmFja2VuZC9yb2xlL2xpc3QnKSxcbiAgICAgICAgaWQgICAgICAgICAgICA6ICdyb2xlTGlzdCcsXG4gICAgICAgIHBhZ2UgICAgICAgICAgOiB0cnVlLFxuICAgICAgICB0b29sYmFyICAgICAgIDogJCgnI29wZXJhdGlvblRvb2xiYXInKS5odG1sKCksXG4gICAgICAgIGRlZmF1bHRUb29sYmFyOiBbXCJmaWx0ZXJcIl0sXG4gICAgICAgIGNlbGxNaW5XaWR0aCAgOiAxMDAsXG4gICAgICAgIGNvbHMgICAgICAgICAgOiBbW1xuICAgICAgICAgIHt0eXBlOiAnY2hlY2tib3gnfSxcbiAgICAgICAgICB7dHlwZTogJ251bWJlcnMnLCB0aXRsZTogJ+W6j+WPtycsIHdpZHRoOiA4MCx9LFxuICAgICAgICAgIHtmaWVsZDogJ3JvbGUnLCB0aXRsZTogJ+inkuiJsicsIHNvcnQ6IGZhbHNlLCB3aWR0aDogMjAwLFxuICAgICAgICAgICAgdGVtcGxldDooZCk9PntcbiAgICAgICAgICAgICAgcmV0dXJuIGQucm9sZSArICAoZC5zeXN0ZW0gPyAnJm5ic3A7PHNwYW4gY2xhc3M9XCJsYXl1aS1iYWRnZSBsYXl1aS1iZy1ncmVlblwiPlM8L3NwYW4+JzonJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtmaWVsZDogJ25hbWUnLCB0aXRsZTogJ+agh+ivhicsIHNvcnQ6IGZhbHNlLCB3aWR0aDogMTAwfSxcbiAgICAgICAgICB7ZmllbGQ6ICdyZW1hcmsnLCB0aXRsZTogJ+Wkh+azqCcsIHNvcnQ6IGZhbHNlfSxcbiAgICAgICAgICB7ZmllbGQ6ICdfb3BzJywgdGl0bGU6ICfmk43kvZwnLCB0b29sYmFyOiAnI3JvbGVUYkJhcicsIGFsaWduOiAnY2VudGVyJywgd2lkdGg6IDE0MCwgbWluV2lkdGg6IDE0MH1cbiAgICAgICAgXV0sXG4gICAgICAgIHRleHQgICAgICAgICAgOiB7XG4gICAgICAgICAgbm9uZTogJzxkaXYgc3R5bGU9XCJwYWRkaW5nOiAxOHB4IDA7XCI+5ZOO5ZGA77yM5b2T5YmN5peg6KeS6Imy5pWw5o2uLOW/q+WOu+a3u+WKoOWQp348L2Rpdj4nXG4gICAgICAgIH0sXG4gICAgICAgIHRyZWUgICAgICAgICAgOiB7XG4gICAgICAgICAgb3Blbk5hbWUgOiAncm9sZScsXG4gICAgICAgICAgaWNvbkluZGV4OiAyLFxuICAgICAgICAgIGlkTmFtZSAgIDogJ2lkJyxcbiAgICAgICAgICBwaWROYW1lICA6ICdwaWQnLFxuICAgICAgICAgIGlzUGlkRGF0YTogdHJ1ZSxcbiAgICAgICAgICBhcnJvd1R5cGU6ICdhcnJvdzInLFxuICAgICAgICAgIGdldEljb24gIDogKGQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAnPGkgY2xhc3M9XCJldy10cmVlLWljb25cIj48L2k+JztcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGxldCBfdGhpcyAgPSB0aGlzO1xuICAgICAgLyog6KGo5qC85pCc57SiICovXG4gICAgICBmb3JtLm9uKCdzdWJtaXQocm9sZVRiU2VhcmNoKScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIF90aGlzLmluc1RiLnJlbG9hZCh7d2hlcmU6IGRhdGEuZmllbGQsIHBhZ2U6IHtjdXJyOiAxfX0pO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KTtcblxuICAgICAgdHJlZVRhYmxlLm9uKCd0b29sKHJvbGVUYWJsZSknLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIGxldCBpZCA9IG9iai5kYXRhLmlkXG4gICAgICAgIHN3aXRjaCAob2JqLmV2ZW50KSB7XG4gICAgICAgICAgY2FzZSAnZWRpdCc6Ly/nvJbovpFcbiAgICAgICAgICAgIF90aGlzLnNob3dFZGl0TW9kZWwob2JqLmRhdGEpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnZGVsJzovL+WIoOmZpFxuICAgICAgICAgICAgX3RoaXMuZG9EZWwoeydpZHMnOiBbaWRdfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdhdXRoJzovL+aOiOadg1xuICAgICAgICAgICAgaW5kZXgub3BlblRhYih7dXJsOiBhZG1pbi51cmwoJ2JhY2tlbmQvcm9sZS9ncmFudD9yaWQ9JyArIGlkKSwgdGl0bGU6IG9iai5kYXRhLnJvbGUgKyAnICcgKyBfdCgnUGVybWlzc2lvbnMnKSwgZW5kOiAnJ30pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAndmlldyc6Ly/mn6XnnItcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdHJlZVRhYmxlLm9uKCd0b29sYmFyKHJvbGVUYWJsZSknLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIGlmIChvYmouZXZlbnQgPT09ICdhZGQnKSB7IC8vIOa3u+WKoFxuICAgICAgICAgIF90aGlzLnNob3dFZGl0TW9kZWwoKTtcbiAgICAgICAgfSBlbHNlIGlmIChvYmouZXZlbnQgPT09ICdkZWwnKSB7IC8vIOWIoOmZpFxuICAgICAgICAgIGxldCBjaGVja1Jvd3MgPSBfdGhpcy5pbnNUYi5jaGVja1N0YXR1cygncm9sZUxpc3QnKTtcbiAgICAgICAgICBpZiAoY2hlY2tSb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbGF5ZXIubXNnKCfor7fpgInmi6nopoHliKDpmaTnmoTop5LoibInLCB7aWNvbjogMn0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgaWRzID0gY2hlY2tSb3dzLm1hcChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgcmV0dXJuIGQuaWQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgX3RoaXMuZG9EZWwoe2lkczogaWRzfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3dFZGl0TW9kZWwobURhdGEpIHtcbiAgICAgIGxldCBpbnNUYiA9IHRoaXMuaW5zVGJcbiAgICAgIGxldCB1cmwgICA9IGFkbWluLnVybChtRGF0YSA/ICdiYWNrZW5kL3JvbGUvc2F2ZScgOiAnYmFja2VuZC9yb2xlL2FkZCcpO1xuICAgICAgYWRtaW4ub3Blbih7XG4gICAgICAgIHR5cGUgICA6IDEsXG4gICAgICAgIGFyZWEgICA6ICc2MDBweCcsXG4gICAgICAgIG9mZnNldCA6IDEwLFxuICAgICAgICB0aXRsZSAgOiAobURhdGEgPyAn5L+u5pS5JyA6ICfmt7vliqAnKSArICfop5LoibInLFxuICAgICAgICBjb250ZW50OiAkKCcjcm9sZUVkaXREaWFsb2cnKS5odG1sKCksXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChsYXllcm8sIGRJbmRleCkge1xuICAgICAgICAgIC8vIOWbnuaYvuihqOWNleaVsOaNrlxuICAgICAgICAgIGZvcm0udmFsKCdyb2xlRWRpdEZvcm0nLCBtRGF0YSk7XG4gICAgICAgICAgLy8g6KGo5Y2V5o+Q5Lqk5LqL5Lu2XG4gICAgICAgICAgZm9ybS5vbignc3VibWl0KHJvbGVFZGl0U3VibWl0KScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBsZXQgbG9hZEluZGV4ID0gbGF5ZXIubG9hZCgyKTtcbiAgICAgICAgICAgIGFkbWluLnBvc3QoYWRtaW4udXJsKHVybCksIGRhdGEuZmllbGQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgbGF5ZXIuY2xvc2UobG9hZEluZGV4KTtcbiAgICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgbGF5ZXIuY2xvc2UoZEluZGV4KTtcbiAgICAgICAgICAgICAgICBsZXQgbXNnID0gbURhdGEgPyAn5L+u5pS5JyA6ICfmt7vliqAnXG4gICAgICAgICAgICAgICAgbm90aWNlLnN1Y2Nlc3MoJ+inkuiJsicgKyBtc2cgKyAn5oiQ5YqfJylcbiAgICAgICAgICAgICAgICBpbnNUYi5yZWZyZXNoKClcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBub3RpY2UuZXJyb3IoZGF0YS5tZXNzYWdlKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIGxheWVyLmNsb3NlKGxvYWRJbmRleCk7XG4gICAgICAgICAgICAgIG5vdGljZS5lcnJvcihkYXRhLm1lc3NhZ2UpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy/mmL7npLrop5LoibLkuIrnuqdcbiAgICAgICAgICBsZXQgaW5zWG1TZWwgPSB4bVNlbGVjdC5yZW5kZXIoe1xuICAgICAgICAgICAgZWwgICAgICAgIDogJyNyb2xlc0VkaXRQYXJlbnRTZWwnLFxuICAgICAgICAgICAgaGVpZ2h0ICAgIDogJzI1MHB4JyxcbiAgICAgICAgICAgIGRhdGEgICAgICA6IFtdLFxuICAgICAgICAgICAgdGlwcyAgICAgIDogJ+ivt+mAieaLqeS4iue6p+inkuiJsicsXG4gICAgICAgICAgICBuYW1lICAgICAgOiAncGlkJyxcbiAgICAgICAgICAgIGluaXRWYWx1ZSA6IG1EYXRhID8gW21EYXRhLnBpZF0gOiBbMF0sXG4gICAgICAgICAgICBtb2RlbCAgICAgOiB7bGFiZWw6IHt0eXBlOiAndGV4dCd9fSxcbiAgICAgICAgICAgIHByb3AgICAgICA6IHtcbiAgICAgICAgICAgICAgbmFtZSA6ICdyb2xlJyxcbiAgICAgICAgICAgICAgdmFsdWU6ICdpZCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByYWRpbyAgICAgOiB0cnVlLFxuICAgICAgICAgICAgY2xpY2tDbG9zZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGxldCBpZCAgICAgICA9IG1EYXRhID8gbURhdGEuaWQgOiAwXG4gICAgICAgICAgYWRtaW4uZ2V0KCdiYWNrZW5kL3JvbGUvbGlzdD9pZD0nICsgaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGxldCB0b3BSb2xlTGlzdCA9IFtdO1xuICAgICAgICAgICAgdG9wUm9sZUxpc3QucHVzaCh7J3JvbGUnOiAn5pegJywgJ2lkJzogMH0pXG4gICAgICAgICAgICB0b3BSb2xlTGlzdCA9IHRvcFJvbGVMaXN0LmNvbmNhdChkYXRhLnRyZWUpXG4gICAgICAgICAgICBpbnNYbVNlbC51cGRhdGUoe1xuICAgICAgICAgICAgICBkYXRhICAgOiB0b3BSb2xlTGlzdCxcbiAgICAgICAgICAgICAgdHJlZSAgIDoge1xuICAgICAgICAgICAgICAgIHNob3cgICAgICAgICAgOiB0cnVlLFxuICAgICAgICAgICAgICAgIHNob3dGb2xkZXJJY29uOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGVudCAgICAgICAgOiAxNSxcbiAgICAgICAgICAgICAgICBzdHJpY3QgICAgICAgIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXhwYW5kZWRLZXlzICA6IFsxXSxcbiAgICAgICAgICAgICAgICBzaW1wbGUgICAgICAgIDogdHJ1ZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgYXV0b1JvdzogdHJ1ZSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgJChsYXllcm8pLmNoaWxkcmVuKCcubGF5dWktbGF5ZXItY29udGVudCcpLmNzcygnb3ZlcmZsb3cnLCAndmlzaWJsZScpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgZG9EZWwob2JqKSB7XG4gICAgICBsZXQgaW5zVGIgPSB0aGlzLmluc1RiXG4gICAgICBsYXllci5jb25maXJtKCfnoa7lrpropoHliKDpmaTpgInkuK3nmoTop5LoibLlkJfvvJ8nLCB7XG4gICAgICAgIHNraW4gOiAnbGF5dWktbGF5ZXItYWRtaW4nLFxuICAgICAgICBzaGFkZTogLjFcbiAgICAgIH0sIGZ1bmN0aW9uIChpKSB7XG4gICAgICAgIGxheWVyLmNsb3NlKGkpO1xuICAgICAgICBsZXQgbG9hZEluZGV4ID0gbGF5ZXIubG9hZCgyKTtcbiAgICAgICAgYWRtaW4ucG9zdCgnYmFja2VuZC9yb2xlL2RlbCcsIG9iaikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGxheWVyLmNsb3NlKGxvYWRJbmRleCk7XG4gICAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICBub3RpY2Uuc3VjY2Vzcygn6KeS6Imy5Yig6Zmk5oiQ5YqfJyk7XG4gICAgICAgICAgICBpbnNUYi5yZWZyZXNoKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5vdGljZS5lcnJvcihkYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkuZmFpbChmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGxheWVyLmNsb3NlKGxvYWRJbmRleCk7XG4gICAgICAgICAgbm90aWNlLmVycm9yKGRhdGEubWVzc2FnZSk7XG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICB9O1xuICB9XG5cbiAgZXhwb3J0cygnQGJhY2tlbmQucm9sZScsIG5ldyBSb2xlKTtcbn0pOyJdLCJmaWxlIjoicm9sZS5qcyJ9
