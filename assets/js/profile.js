/** wulacms-v3.0.0 MIT License By https://github.com/ninggf/wulacms */
 ;layui.injectCss("cmp-user-profile",".user-info-head{width:110px;height:110px;line-height:110px;position:relative;display:inline-block;border:2px solid #eee;border-radius:50%;overflow:hidden;cursor:pointer;margin:0 auto}.user-info-head:hover:after{content:'\\e681';position:absolute;top:0;left:0;right:0;bottom:0;color:#fff;background-color:rgba(0,0,0,.3);font-size:28px;padding-top:2px;font-style:normal;font-family:layui-icon;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.user-info-head img{width:110px;height:110px}.user-info-list-item{position:relative;padding-bottom:8px}.user-info-list-item>.layui-icon{position:absolute}.user-info-list-item>p{padding-left:30px}.layui-line-dash{border-bottom:1px dashed #ccc;margin:15px 0}#userInfoForm .layui-form-item{margin-bottom:25px}.user-bd-list-item{padding:14px 60px 14px 10px;border-bottom:1px solid #e8e8e8;position:relative}.user-bd-list-item .user-bd-list-lable{color:#333;margin-bottom:4px}.user-bd-list-item .user-bd-list-oper{position:absolute;top:50%;right:10px;margin-top:-8px;cursor:pointer}.user-bd-list-item .user-bd-list-img{width:48px;height:48px;line-height:48px;position:absolute;top:50%;left:10px;margin-top:-24px}.user-bd-list-item .user-bd-list-img+.user-bd-list-content{margin-left:68px}"),layui.define(["layer","form","formX","element","admin","notice"],function(e){var t=layui.jquery,i=layui.form,o=layui.admin,r=layui.notice;e("@backend.profile",new(function(){function e(){}return e.prototype.init=function(){t("#userInfoHead").click(function(){o.cropImg({imgSrc:t("#userInfoHead>img").attr("src"),onCrop:function(e){o.post(o.url("backend/upload/raw/avatar"),e,{contentType:"text/plain"}).then(function(i){i&&200===i.code&&o.post("backend/profile/avatar",{avatar:i.result.url}).then(function(e){e&&200===e.code&&(t("#userInfoHead > img").attr("src",i.result.url),parent.layui.jquery(".layui-layout-admin>.layui-header .layui-nav img.layui-nav-img").attr("src",i.result.url))})})}})}),i.on("submit(userInfoSubmit)",function(e){return o.post(o.url("backend/profile/save"),e.field).then(function(e){200===e.code?(r.success({message:"用户信息更新成功",title:"SUCCESS",timeout:2e3}),setTimeout(function(){o.refresh()},2e3)):r.error(e.message)}).fail(function(e){r.error(e.message)}),!1}),i.on("submit(submit-psw)",function(e){return o.post(o.url("backend/profile/passwd"),e.field).then(function(e){200===e.code?r.success("密码修改成功"):r.error(e.message)}).fail(function(e){r.error(e.message)}),!1})},e}()))});