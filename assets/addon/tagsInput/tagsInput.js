/** wulacms-v3.0.0 MIT License By https://github.com/ninggf/wulacms */
 ;!function(i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof exports?module.exports=i:window.layui&&layui.define?layui.define("jquery",function(t){var a=layui.jquery;layui.link(layui.cache.base+"tagsInput/tagsInput.css"),t("tagsInput",i(a))}):i(jQuery)}(function(o){var r=o,l=new Array,p=new Array;o.fn.doAutosize=function(t){var a=o(this).data("minwidth"),i=o(this).data("maxwidth"),e="",n=o(this),s=o("#"+o(this).data("tester_id"));e!==(e=n.val())&&(e=e.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s.html(e),((t=(s=s.width())+t.comfortZone>=a?s+t.comfortZone:a)<n.width()&&a<=t||a<t&&t<i)&&n.width(t))},o.fn.resetAutosize=function(t){o(this).data("minwidth")||t.minInputWidth||o(this).width();var a=o(this).data("maxwidth")||t.maxInputWidth||o(this).closest(".tagsinput").width()-t.inputPadding,i=o(this),e=o("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),t=o(this).attr("id")+"_autosize_tester";0<!o("#"+t).length&&(e.attr("id",t),e.appendTo("body")),i.data("maxwidth",a),i.data("tester_id",t)},o.fn.addTag=function(e,n){return n=r.extend({focus:!1,callback:!0},n),this.each(function(){var t,a=o(this).attr("id"),i=o(this).val().split(l[a]);""==i[0]&&(i=new Array),e=r.trim(e),n.unique?1==(t=o(this).tagExist(e))&&o("#"+a+"_tag").addClass("not_valid"):t=!1,""!=e&&1!=t&&(t='<span class="default-close-text">&times;</span>',layui&&(t='<i class="layui-icon layui-icon-close"></i>'),o("<span>").addClass("tag").append(o("<span>").text(e).append("&nbsp;&nbsp;"),o("<a>",{href:"javascript:;",title:"移除",html:t}).click(function(){return o("#"+a).removeTag(escape(e))})).insertBefore("#"+a+"_addTag"),i.push(e),o("#"+a+"_tag").val(""),o("#"+a+"_tag").parent().find(".tagsinput-tip-list").remove(),n.focus?o("#"+a+"_tag").focus():o("#"+a+"_tag").blur(),o.fn.tagsInput.updateTagsField(this,i),n.callback&&p[a]&&p[a].onAddTag&&p[a].onAddTag.call(this,e),p[a]&&p[a].onChange&&(t=i.length,p[a].onChange.call(this,o(this),i[t-1])))}),!1},o.fn.removeTag=function(e){return e=unescape(e),this.each(function(){var t=o(this).attr("id"),a=o(this).val().split(l[t]);for(o("#"+t+"_tagsinput .tag").remove(),str="",i=0;i<a.length;i++)a[i]!=e&&(str=str+l[t]+a[i]);o.fn.tagsInput.importTags(this,str),p[t]&&p[t].onRemoveTag&&p[t].onRemoveTag.call(this,e)}),!1},o.fn.tagExist=function(t){var a=o(this).attr("id"),a=o(this).val().split(l[a]);return 0<=r.inArray(t,a)},o.fn.importTags=function(t){var a=o(this).attr("id");o("#"+a+"_tagsinput .tag").remove(),o.fn.tagsInput.importTags(this,t)},o.fn.tagsInput=function(t){t&&"tagsinput-default"==t.skin&&null==t.focusWithClick&&(t.focusWithClick=!1);var d=r.extend({interactive:!0,defaultText:"+请输入",minChars:0,width:"",height:"",autocomplete:{type:"get",data:{}},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!1,focusWithClick:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12,skin:""},t),a=0;return this.each(function(){var s,u,t;void 0===o(this).attr("data-tagsinput-init")&&(o(this).attr("data-tagsinput-init",!0),d.hide&&(o(this).hide(),o(this).addClass("ew-tagsinput-hide")),(s=o(this).attr("id"))&&!l[o(this).attr("id")]||(s=o(this).attr("id","tags"+(new Date).getTime()+a++).attr("id")),u=r.extend({pid:s,real_input:"#"+s,holder:"#"+s+"_tagsinput",input_wrapper:"#"+s+"_addTag",fake_input:"#"+s+"_tag"},d),l[s]=u.delimiter,(d.onAddTag||d.onRemoveTag||d.onChange)&&(p[s]=new Array,p[s].onAddTag=d.onAddTag,p[s].onRemoveTag=d.onRemoveTag,p[s].onChange=d.onChange),t='<div id="'+s+'_tagsinput" class="tagsinput '+d.skin+'"><div id="'+s+'_addTag">',d.interactive&&(t=t+'<input id="'+s+'_tag" value="" placeholder="'+d.defaultText+'" autocomplete="off" />'),o(t+="</div></div>").insertAfter(this),o(u.holder).css("width",d.width),o(u.holder).css("min-height",d.height),o(u.holder).css("height",d.height),""!=o(u.real_input).val()&&o.fn.tagsInput.importTags(o(u.real_input),o(u.real_input).val()),d.interactive&&(o(u.fake_input).resetAutosize(d),d.focusWithClick&&o(u.holder).bind("click",u,function(t){o(t.data.fake_input).focus()}),null!=d.autocomplete_url?o(u.fake_input).on("input",function(){var t=o(this).val();t?(d.autocomplete.data.name=t,o.ajax({url:d.autocomplete_url,type:d.autocomplete.type,data:d.autocomplete.data,dataType:"json",success:function(t){if(200==t.code){var a=o(u.fake_input).parent().find(".tagsinput-tip-list");0==t.data.length&&a.remove();for(var i="",e=0;e<t.data.length;e++){var n=t.data[e];i+='<li data-value="'+n+'">'+n+"</li>"}a.length<=0&&(o(u.fake_input).after('<ul class="tagsinput-tip-list"></ul>'),(a=o(u.fake_input).parent().find(".tagsinput-tip-list")).on("click",">li",function(){var t=o(this).data("value");o("#"+s).addTag(t,{focus:!0,unique:d.unique}),a.remove()})),a.html(i)}}})):o(u.fake_input).parent().find(".tagsinput-tip-list").remove()}):o(u.fake_input).bind("blur",u,function(t){return""!=o(t.data.fake_input).val()&&t.data.minChars<=o(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=o(t.data.fake_input).val().length)&&o(t.data.real_input).addTag(o(t.data.fake_input).val(),{focus:!1,unique:d.unique}),!1}),o(u.fake_input).bind("keypress",u,function(t){return e(t)?(t.preventDefault(),t.data.minChars<=o(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=o(t.data.fake_input).val().length)&&o(t.data.real_input).addTag(o(t.data.fake_input).val(),{focus:!0,unique:d.unique}),o(t.data.fake_input).resetAutosize(d),!1):void(t.data.autosize&&o(t.data.fake_input).doAutosize(d))}),u.removeWithBackspace&&o(u.fake_input).bind("keydown",function(t){var a;8==t.keyCode&&""==o(this).val()&&(t.preventDefault(),a=o(this).closest(".tagsinput").find(".tag:last").text(),t=o(this).attr("id").replace(/_tag$/,""),a=(a=a.replace(/[\s]+x$/,"")).replace(/\s/g,""),o("#"+t).removeTag(escape(a)),o(this).trigger("focus"))}),o(u.fake_input).blur(),u.unique&&o(u.fake_input).keydown(function(t){8!=t.keyCode&&!String.fromCharCode(t.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)||o(this).removeClass("not_valid")})))}),this},o.fn.tagsInput.updateTagsField=function(t,a){var i=o(t).attr("id");o(t).val(a.join(l[i]))},o.fn.tagsInput.importTags=function(t,a){o(t).val("");var e=o(t).attr("id"),n=a.split(l[e]);for(i=0;i<n.length;i++)o(t).addTag(n[i],{focus:!1,callback:!1});p[e]&&p[e].onChange&&p[e].onChange.call(t,t,n[i])};var e=function(i){var e=!1;return 13==i.which||("string"==typeof i.data.delimiter?i.which==i.data.delimiter.charCodeAt(0)&&(e=!0):o.each(i.data.delimiter,function(t,a){i.which==a.charCodeAt(0)&&(e=!0)}),e)}});