/** wulacms-v3.0.0 MIT License By https://github.com/ninggf/wulacms */
 ;layui.define(["jquery"],function(e){var A=layui.jquery;A("#ew-css-cascader").length<=0&&layui.link(layui.cache.base+"cascader/cascader.css");var S=[],W={render:function(e){var a=(e=A.extend({renderFormat:function(e,a){return e.join(" / ")},clearable:!0,clearAllActive:!1,disabled:!1,trigger:"click",changeOnSelect:!1,filterable:!1,notFoundText:"没有匹配数据"},e)).elem,t=e.data,d=e.renderFormat,i=e.clearable,l=e.clearAllActive,s=e.disabled,n=e.trigger,h=e.changeOnSelect,u=e.reqData,c=e.filterable,o=e.notFoundText,v=e.reqSearch,w=e.onChange,r=e.onVisibleChange,p=e.itemHeight,f=!0,g=A(a);if(g.next().hasClass("ew-cascader-group")){g.next().remove();for(var m=0;m<S.length;m++)if(a==S[m].elem){S.splice(m,1);break}}S.push({elem:a,onVisibleChange:r}),g.addClass("ew-cascader-hide");e='<div class="ew-cascader-group">';e+='      <div class="ew-cascader-input-group">',e+='         <input class="layui-input ew-cascader-input" readonly/>',e+='         <input class="layui-input ew-cascader-input-search"/>',e+='         <i class="layui-icon layui-icon-triangle-d ew-icon-arrow"></i>',e+='         <i class="layui-icon layui-icon-loading-1 layui-anim layui-anim-rotate layui-anim-loop ew-icon-loading"></i>',e+='         <i class="layui-icon layui-icon-close-fill ew-icon-clear"></i>',e+="      </div>",e+='      <div class="ew-cascader-dropdown layui-anim layui-anim-upbit"></div>',e+='      <div class="ew-cascader-search-list"></div>',e+="   </div>",g.after('<div class="ew-cascader-group">      <div class="ew-cascader-input-group">         <input class="layui-input ew-cascader-input" readonly/>         <input class="layui-input ew-cascader-input-search"/>         <i class="layui-icon layui-icon-triangle-d ew-icon-arrow"></i>         <i class="layui-icon layui-icon-loading-1 layui-anim layui-anim-rotate layui-anim-loop ew-icon-loading"></i>         <i class="layui-icon layui-icon-close-fill ew-icon-clear"></i>      </div>      <div class="ew-cascader-dropdown layui-anim layui-anim-upbit"></div>      <div class="ew-cascader-search-list"></div>   </div>');var C=g.next(),y=C.children(".ew-cascader-input-group"),b=y.children(".ew-cascader-input"),k=y.children(".ew-cascader-input-search"),_=C.children(".ew-cascader-dropdown"),P=C.children(".ew-cascader-search-list");b.attr("placeholder",g.attr("placeholder")),s&&b.addClass("layui-disabled");var x={data:t,getData:function(){return t},open:function(){C.hasClass("ew-cascader-open")||(W.hideAll(),C.addClass("ew-cascader-open"),W.checkWidthPosition(_),W.checkHeightPosition(_),r&&r(!0),c&&(y.addClass("show-search"),k.focus()))},hide:function(){C.hasClass("ew-cascader-open")&&(C.removeClass("ew-cascader-open"),C.removeClass("dropdown-show-top"),C.removeClass("dropdown-show-left"),W.hideAllSearch(),r&&r(!1))},removeLoading:function(){C.removeClass("show-loading"),_.find(".ew-cascader-dropdown-list-item").removeClass("show-loading")},setDisabled:function(e){e?(b.addClass("layui-disabled"),x.hide()):b.removeClass("layui-disabled")},getValue:function(){return g.val()},getLabel:function(){return b.val()},setValue:function(e){if(null==e||null==e||!e.toString())return b.val(""),g.val(""),l||h?(_.children(".ew-cascader-dropdown-list").not(":first").remove(),_.find(".ew-cascader-dropdown-list-item").removeClass("active"),W.checkWidthPosition(_)):_.find(".ew-cascader-dropdown-list-item.is-last").removeClass("active"),void y.removeClass("show-clear");e=e.toString().split(",");var o=[];!function i(l,a,s,n,c){function r(e){for(var a=0;a<e.length;a++)if(e[a].value==n[s]){o[s]=e[a].label,l[s]=e[a].value,s<n.length-1?i(l,e[a],s+1,n,c):c();break}}!l&&a?(l=[],r(a)):l&&a&&a.children?r(a.children):(C.addClass("show-loading"),u(l,function(e){l?a.children=e:(t=e,l=[]),r(e)},a))}(void 0,t,0,e,function(){C.removeClass("show-loading"),b.val(d(o,e)),g.val(e.join(","))})}};return x.setValue(g.val()),y.off("click").on("click",function(e){function a(){var e=g.val().toString();if(e){e=e.split(",");for(var a=0;a<e.length;a++){var i=_.children(".ew-cascader-dropdown-list").eq(a).children('.ew-cascader-dropdown-list-item[data-value="'+e[a]+'"]');a==e.length-1?i.addClass("active"):i.trigger("click")}}else x.setValue()}b.hasClass("layui-disabled")||C.hasClass("show-loading")||(C.hasClass("ew-cascader-open")?c||x.hide():f?t?(f=!1,V(_,t,void 0,p),a(),x.open()):(C.addClass("show-loading"),u(void 0,function(e){f=!1,V(_,t=e,void 0,p),C.removeClass("show-loading"),x.open()},void 0)):(a(),x.open()))}),y.children(".ew-icon-arrow").off("click").on("click",function(e){C.hasClass("ew-cascader-open")&&(x.hide(),e.stopPropagation())}),_.off("click").on("click",".ew-cascader-dropdown-list-item",function(){var a=A(this);if(a.hasClass("active"))a.hasClass("is-last")&&x.hide();else if(!a.hasClass("ew-cascader-disabled")&&!a.parent().parent().find(".ew-cascader-dropdown-list-item").hasClass("show-loading")){for(var i=a.data("index").toString(),e=i.split("-"),l=t[parseInt(e[0])],s=[l.value],n=[l.label],c=1;c<e.length;c++)l=l.children[parseInt(e[c])],s[c]=l.value,n[c]=l.label;l.haveChildren?(l.children?(a.parent().nextAll().remove(),W.checkWidthPosition(_),r(),V(_,l.children,i,p)):(a.addClass("show-loading"),u(s,function(e){l.children=e,a.parent().nextAll().remove(),W.checkWidthPosition(_),r(),V(_,e,i,p),a.removeClass("show-loading")},l)),h&&(r(),o())):(a.parent().nextAll().remove(),r(),o(),x.hide())}function r(){a.parent().children(".ew-cascader-dropdown-list-item").removeClass("active"),a.addClass("active")}function o(){b.val(d(n,s)),g.val(s.join(",")),g.removeClass("layui-form-danger"),w&&w(s,l)}}),"hover"==n&&_.off("mouseenter").on("mouseenter",".ew-cascader-dropdown-list-item",function(){A(this).hasClass("is-last")||A(this).trigger("click")}),i&&(y.off("mouseenter").on("mouseenter",function(){g.val().toString()&&!b.hasClass("layui-disabled")&&A(this).addClass("show-clear")}),y.off("mouseleave").on("mouseleave",function(){A(this).removeClass("show-clear")}),y.children(".ew-icon-clear").off("click").on("click",function(e){e.stopPropagation(),x.setValue(),w&&w()})),c&&(k.off("input").on("input",function(){var e=A(this).val();if(!e)return C.removeClass("show-search-list"),void y.removeClass("have-value");if(y.addClass("have-value"),v)v(e,function(e){H(P,e,o),C.addClass("show-search-list")},t);else{var r=[],a=[];!function e(a,i,l,s){for(var n=0;n<a.length;n++){var c=a[n];c.__label=i?i+" / "+c.label:c.label,c.__value=l?l+","+c.value:c.value,c.__disabled=c.disabled||s,c.children&&c.children.length?(e(c.children,c.__label,c.__value,c.__disabled),delete c.__label,delete c.__value):r.push({label:c.__label,value:c.__value,disabled:c.__disabled})}}(t);for(var i=0;i<r.length;i++){var l=r[i];-1<l.label.indexOf(e)&&(l.label=l.label.replace(new RegExp(e,"g"),'<span class="search-keyword">'+e+"</span>"),a.push(l))}H(P,a,o),C.addClass("show-search-list")}}),P.off("click").on("click",".ew-cascader-search-list-item",function(e){if(e.stopPropagation(),!A(this).hasClass("ew-cascader-disabled")){e=A(this).data("value").toString();x.hide(),x.setValue(e);for(var a=e.split(","),i=x.getData(),l=0;l<a.length;l++)for(var s=0;s<i.length;s++)if(i[s].value==a[l]){i=l===a.length-1?i[s]:i[s].children;break}w&&w(a,i)}})),x},hideAll:function(){W.hideAllSearch();for(var e=0;e<S.length;e++){var a=S[e].elem,i=S[e].onVisibleChange,a=A(a).next();a.hasClass("ew-cascader-open")&&(a.removeClass("ew-cascader-open"),a.removeClass("dropdown-show-top"),a.removeClass("dropdown-show-left"),i&&i(!1))}},hideAllSearch:function(){A(".ew-cascader-input-group").removeClass("show-search"),A(".ew-cascader-group").removeClass("show-search-list"),A(".ew-cascader-input-group").removeClass("have-value"),A(".ew-cascader-input-search").val("")},getPageHeight:function(){return document.documentElement.clientHeight||document.body.clientHeight},getPageWidth:function(){return document.documentElement.clientWidth||document.body.clientWidth},checkWidthPosition:function(e){e.offset().left+e.outerWidth()>W.getPageWidth()?e.parent().addClass("dropdown-show-left"):e.parent().removeClass("dropdown-show-left")},checkHeightPosition:function(e){e.offset().top+e.outerHeight()>W.getPageHeight()&&(e.parent().addClass("dropdown-show-top"),e.offset().top<0&&e.parent().removeClass("dropdown-show-top"))},getCityData:function(e){for(var a=0;a<e.length;a++)e[a].value=e[a].label,e[a].children&&(e[a].children=W.getCityData(e[a].children));return e},getCity:function(e){for(var a=0;a<e.length;a++)for(var i=0;i<e[a].children.length;i++)delete e[a].children[i].children;return e},getProvince:function(e){for(var a=0;a<e.length;a++)delete e[a].children;return e}},V=function(e,a,i,l){for(var s='<div class="ew-cascader-dropdown-list" '+(l?' style="height:'+l+';"':"")+">",n=0;n<a.length;n++){var c=a[n],r=null==i?n:i+"-"+n;null==c.haveChildren&&(c.haveChildren=!!c.children);var o=c.haveChildren?"":" is-last";c.disabled&&(o+=" ew-cascader-disabled"),s+='   <div class="ew-cascader-dropdown-list-item'+o+'" data-index="'+r+'" data-value="'+c.value+'">'+c.label+'<i class="layui-icon layui-icon-right ew-icon-right"></i><i class="layui-icon layui-icon-loading-1 layui-anim layui-anim-rotate layui-anim-loop ew-icon-loading"></i></div>'}s+="   </div>",e.append(s),W.checkWidthPosition(e)},H=function(e,a,i){var l="";if(0==a.length)l='<div class="ew-cascader-search-list-empty">'+i+"</div>";else for(var s=0;s<a.length;s++){var n=a[s];l+='<div class="ew-cascader-search-list-item'+(n.disabled?" ew-cascader-disabled":"")+'" data-value="'+n.value+'">'+n.label+"</div>"}e.html(l)};A(document).off("click.cascader").on("click.cascader",function(e){try{var a,i=e.target.className.split(" "),l=["ew-cascader-group","ew-cascader-input","ew-icon-arrow","ew-cascader-dropdown","ew-cascader-dropdown-list","ew-cascader-dropdown-list-item","ew-icon-right","ew-cascader-input-search","ew-cascader-search-list","ew-cascader-search-list-item"];for(a in i)for(var s in l)if(i[a]==l[s])return}catch(e){}W.hideAll()}),e("cascader",W)});