/** wulacms-v3.0.0 MIT License By https://github.com/ninggf/wulacms */
 ;layui.define(["layer","element","admin","toastr"],function(a){var l=layui.jquery,t=layui.layer,n=layui.element,o=layui.admin,s=o.setter,e=".layui-layout-admin>.layui-header",u=".layui-layout-admin>.layui-side>.layui-side-scroll",d=".layui-layout-admin>.layui-body",r=d+">.layui-tab",c=d+">.layui-body-header",m="admin-pagetabs",i="admin-side-nav",y={},h=!1,b={homeUrl:void 0,mTabPosition:void 0,mTabList:[]};layui.admin.toast=layui.toastr,b.loadView=function(a){if(!a.menuPath)return t.msg("url不能为空",{icon:2,anim:6});if(s.pageTabs){var i;if(l(r+">.layui-tab-title>li").each(function(){l(this).attr("lay-id")===a.menuPath&&(i=!0)}),!i){if(b.mTabList.length+1>=s.maxTabNum)return t.msg("最多打开"+s.maxTabNum+"个选项卡",{icon:2,anim:6}),o.activeNav(b.mTabPosition);h=!0,n.tabAdd(m,{id:a.menuPath,title:'<span class="title">'+(a.menuName||"")+"</span>",content:'<iframe class="admin-iframe" lay-id="'+a.menuPath+'" src="'+a.menuPath+'" onload="layui.index.hideLoading(this);" frameborder="0"></iframe>'}),o.showLoading({elem:l('iframe[lay-id="'+a.menuPath+'"]').parent(),size:""}),a.menuPath!==b.homeUrl&&b.mTabList.push(a),s.cacheTab&&o.putTempData("indexTabs",b.mTabList)}a.noChange||n.tabChange(m,a.menuPath)}else{o.activeNav(a.menuPath);var e=l(d+">div>.admin-iframe");if(0===e.length?(l(d).html(['<div class="layui-body-header">','   <span class="layui-body-header-title"></span>','   <span class="layui-breadcrumb pull-right" lay-filter="admin-body-breadcrumb" style="visibility: visible;"></span>',"</div>",'<div style="-webkit-overflow-scrolling: touch;">','   <iframe class="admin-iframe" lay-id="',a.menuPath,'" src="',a.menuPath,'"','      onload="layui.index.hideLoading(this);" frameborder="0"></iframe>',"</div>"].join("")),o.showLoading({elem:l('iframe[lay-id="'+a.menuPath+'"]').parent(),size:""})):(o.showLoading({elem:e.parent(),size:""}),e.attr("lay-id",a.menuPath).attr("src",a.menuPath)),l('[lay-filter="admin-body-breadcrumb"]').html(b.getBreadcrumbHtml(a.menuPath)),b.mTabList.splice(0,b.mTabList.length),a.menuPath===b.homeUrl?(b.mTabPosition=void 0,b.setTabTitle(l(a.menuName).text()||l(u+' [lay-href="'+b.homeUrl+'"]').text()||"主页")):(b.mTabPosition=a.menuPath,b.mTabList.push(a),b.setTabTitle(a.menuName)),!s.cacheTab)return;o.putTempData("indexTabs",b.mTabList),o.putTempData("tabPosition",b.mTabPosition)}o.getPageWidth()<=768&&o.flexible(!0)},b.loadHome=function(a){var i=o.getTempData("indexTabs"),e=o.getTempData("tabPosition"),t=(void 0===a.loadSetting||a.loadSetting)&&s.cacheTab&&i&&0<i.length;if(b.homeUrl=a.menuPath,a.noChange=!!e&&t,!s.pageTabs&&t||b.loadView(a),t)for(var l=0;l<i.length;l++)i[l].noChange=i[l].menuPath!==e,i[l].noChange&&(!s.pageTabs||a.onlyLast)||b.loadView(i[l]);o.removeLoading(void 0,!1)},b.openTab=function(a){if(window!==top&&!o.isTop()&&top.layui&&top.layui.index)return top.layui.index.openTab(a);a.end&&(y[a.url]=a.end),b.loadView({menuPath:a.url,menuName:a.title})},b.closeTab=function(a){if(window!==top&&!o.isTop()&&top.layui&&top.layui.index)return top.layui.index.closeTab(a);n.tabDelete(m,a)},b.setTabCache=function(a){return window!==top&&!o.isTop()&&top.layui&&top.layui.index?top.layui.index.setTabCache(a):(o.putSetting("cacheTab",a),a?(o.putTempData("indexTabs",b.mTabList),void o.putTempData("tabPosition",b.mTabPosition)):b.clearTabCache())},b.clearTabCache=function(){o.putTempData("indexTabs",null),o.putTempData("tabPosition",null)},b.setTabTitle=function(a,i){if(window!==top&&!o.isTop()&&top.layui&&top.layui.index)return top.layui.index.setTabTitle(a,i);s.pageTabs?(i=i||l(r+">.layui-tab-title>li.layui-this").attr("lay-id"))&&l(r+'>.layui-tab-title>li[lay-id="'+i+'"] .title').html(a||""):a?(l(c+">.layui-body-header-title").html(a),l(c).addClass("show"),l(e).css("box-shadow","0 1px 0 0 rgba(0, 0, 0, .03)")):(l(c).removeClass("show"),l(e).css("box-shadow",""))},b.setTabTitleHtml=function(a){if(window!==top&&!o.isTop()&&top.layui&&top.layui.index)return top.layui.index.setTabTitleHtml(a);if(!s.pageTabs){if(!a)return l(c).removeClass("show");l(c).html(a),l(c).addClass("show")}},b.getBreadcrumb=function(a){a=a||l(d+">div>.admin-iframe").attr("lay-id");var i=[],e=l(u).find('[lay-href="'+a+'"]');for(0<e.length&&i.push(e.text().replace(/(^\s*)|(\s*$)/g,""));0!==(e=e.parent("dd").parent("dl").prev("a")).length;)i.unshift(e.text().replace(/(^\s*)|(\s*$)/g,""));return i},b.getBreadcrumbHtml=function(a){for(var i=b.getBreadcrumb(a),e=a===b.homeUrl?"":'<a ew-href="'+b.homeUrl+'">首页</a>',t=0;t<i.length-1;t++)e&&(e+='<span lay-separator="">/</span>'),e+="<a><cite>"+i[t]+"</cite></a>";return e},b.hideLoading=function(a){"string"!=typeof a&&(a=l(a).attr("lay-id")),o.removeLoading(l('iframe[lay-id="'+a+'"],'+d+" iframe[lay-id]").parent(),!1)};var p=".layui-layout-admin .site-mobile-shade";0===l(p).length&&l(".layui-layout-admin").append('<div class="site-mobile-shade"></div>'),l(p).click(function(){o.flexible(!0)}),s.pageTabs&&0===l(r).length&&(l(d).html(['<div class="layui-tab" lay-allowClose="true" lay-filter="',m,'" lay-autoRefresh="',"true"==s.tabAutoRefresh,'">','   <ul class="layui-tab-title"></ul><div class="layui-tab-content"></div>',"</div>",'<div class="layui-icon admin-tabs-control layui-icon-prev" ew-event="leftPage"></div>','<div class="layui-icon admin-tabs-control layui-icon-next" ew-event="rightPage"></div>','<div class="layui-icon admin-tabs-control layui-icon-down">','   <ul class="layui-nav" lay-filter="admin-pagetabs-nav">','      <li class="layui-nav-item" lay-unselect>','         <dl class="layui-nav-child layui-anim-fadein">','            <dd ew-event="closeThisTabs" lay-unselect><a>关闭当前标签页</a></dd>','            <dd ew-event="closeOtherTabs" lay-unselect><a>关闭其它标签页</a></dd>','            <dd ew-event="closeAllTabs" lay-unselect><a>关闭全部标签页</a></dd>',"         </dl>","      </li>","   </ul>","</div>"].join("")),n.render("nav","admin-pagetabs-nav")),n.on("nav("+i+")",function(a){var i=l(a),e=i.attr("lay-href");if(e&&"#"!==e){if(0===e.indexOf("javascript:"))return new Function(e.substring(11))();var a=i.attr("ew-title")||i.text().replace(/(^\s*)|(\s*$)/g,""),t=i.attr("ew-end");try{t=t?new Function(t):void 0}catch(a){}b.openTab({url:e,title:a,end:t}),layui.event.call(this,"admin","side({*})",{href:e})}}),n.on("tab("+m+")",function(){var a=l(this).attr("lay-id");b.mTabPosition=a!==b.homeUrl?a:void 0,s.cacheTab&&o.putTempData("tabPosition",b.mTabPosition),o.activeNav(a),o.rollPage("auto"),"true"!=l(r).attr("lay-autoRefresh")||h||o.refresh(a,!0),h=!1,layui.event.call(this,"admin","tab({*})",{layId:a})}),n.on("tabDelete("+m+")",function(a){var i=b.mTabList[a.index-1];i&&(b.mTabList.splice(a.index-1,1),s.cacheTab&&o.putTempData("indexTabs",b.mTabList),y[i.menuPath]&&y[i.menuPath].call(),layui.event.call(this,"admin","tabDelete({*})",{layId:i.menuPath})),0===l(r+">.layui-tab-title>li.layui-this").length&&l(r+">.layui-tab-title>li:last").trigger("click")}),l(document).off("click.navMore").on("click.navMore","[nav-bind]",function(){var a=l(this).attr("nav-bind");l('ul[lay-filter="'+i+'"]').addClass("layui-hide"),l('ul[nav-id="'+a+'"]').removeClass("layui-hide"),l(e+">.layui-nav .layui-nav-item").removeClass("layui-this"),l(this).parent(".layui-nav-item").addClass("layui-this"),o.getPageWidth()<=768&&o.flexible(!1),layui.event.call(this,"admin","nav({*})",{navId:a})}),s.openTabCtxMenu&&s.pageTabs&&layui.use("contextMenu",function(){layui.contextMenu&&l(r+">.layui-tab-title").off("contextmenu.tab").on("contextmenu.tab","li",function(a){var i=l(this).attr("lay-id");return layui.contextMenu.show([{icon:"layui-icon layui-icon-refresh",name:"刷新当前",click:function(){n.tabChange(m,i),"true"!=l(r).attr("lay-autoRefresh")&&o.refresh(i)}},{icon:"layui-icon layui-icon-close-fill ctx-ic-lg",name:"关闭当前",click:function(){o.closeThisTabs(i)}},{icon:"layui-icon layui-icon-unlink",name:"关闭其他",click:function(){o.closeOtherTabs(i)}},{icon:"layui-icon layui-icon-close ctx-ic-lg",name:"关闭全部",click:function(){o.closeAllTabs()}}],a.clientX,a.clientY),!1})}),a("index",b)});